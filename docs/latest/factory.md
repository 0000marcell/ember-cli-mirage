---
layout: docs
title: Factory
---

Factories are used in your tests. Their purpose is to make it easy to populate your Mirage server's database with data. So whenever you generate an object via a factory, it will automatically get added to the db, and thus get an `id` assigned to it.

Define factories by creating files under `/mirage/factories/some-factory.js`. The name of the factory, which you reference in your tests, is determined by the filename.

Factories have attributes, and you create objects from factory definitions using `create` and `createList`.

## Defining factories

### Attributes

Attributes can be static (strings and numbers) or dyanmic (a function).

Here are some static attributes:

```js
// mirage/factories/contact.js
import Mirage from 'ember-cli-mirage';

export default Mirage.Factory.extend({
  name: 'Link',
  age: 563
});
```

Each time this factory is used to create an object, it will have a `name` property of "Link" and an `age` property of 563. It will also have an autogenerated `id` assigned to it, since it was inserted into the database.

For dynamic properties, use a function:

```js
// mirage/factories/contact.js
import Mirage from 'ember-cli-mirage';

export default Mirage.Factory.extend({
  name: function(i) {
    return 'Contact' + i
  }
});
```

*i* here is the sequence of the contact generated. So the first contact generated (per test) would have a name of `Contact1`, the second would have a name of `Contact2`, and so on.

Finally, you can also reference static attributes (numbers or strings) within your dynamic attributes via `this`:

```js
// mirage/factories/contact.js
import Mirage from 'ember-cli-mirage';

export default Mirage.Factory.extend({
  age: 18,
  is_admin: function(i) {
    return this.age > 30;
  }
});
```

You should define the attributes of your factory as the "base case" for your objects, and 
override them within your tests. We'll discuss how do to this next.

### Extending factories

You can extend your own factories.

```js
// mirage/factories/human.js
import Mirage from 'ember-cli-mirage';

export default Mirage.Factory.extend({
  species: 'homo sapiens'
});

// mirage/factories/man.js
import Human from './human';

export default Human.extend({
  gender: 'male'
});
```

## Creating objects

Once you've defined a factory for a model, you can generate data for that model using
server.create and server.createList from within your acceptance tests.

<a name="create" href="Factories#create">#</a> server.<b>create</b>(<i>type</i> [, <i>attrs</i>])

Generates a single model of type *type*, inserts it into the database (giving it an id), and returns the data that was
added.

```js
test("I can view a contact's details", function() {
  var contact = server.create('contact');

  visit('/contacts/' + contact.id);

  andThen(function() {
    equal(currentRouteName(), 'contact');
    equal( find('h1').text(), 'The contact is Link');
  });
});
```

You can override the attributes from the factory definition with a
hash passed in as the second parameter. For example, if we had this factory

```js
export default Mirage.Factory.extend({
  name: 'Link'
});
```

we could override the name like this:

```js
test("I can view the contacts", function() {
  server.create('contact');
  server.create('contact', {name: 'Zelda'});

  visit('/');

  andThen(function() {
    equal(currentRouteName(), 'index');
    equal( find('p').length, 2 );
    equal( find('p')[0].text(), 'Link' );
    equal( find('p')[1].text(), 'Zelda' );
  });
});
```

<a name="createList" href="Factories#createList">#</a> server.<b>createList</b>(<i>type</i>, <i>amount</i> [, <i>attrs</i>])

Creates *amount* models of type *type*, optionally overriding the attributes from the factory with *attrs*.

Returns the array of records that were added to the database.

```js
test("I can view the contacts", function() {
  server.createList('contact', 5);
  var youngContacts = server.createList('contact', 5, {age: 15});

  visit('/');

  andThen(function() {
    equal(currentRouteName(), 'index');
    equal( find('p').length, 10 );
  });
});
```
